ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21) +
scale_size(range = c(10,17), name = "Percentage (%)") +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21) +
scale_size(range = c(1,1), name = "Percentage (%)") +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21, fill = healt_board) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21, fill = health_board) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21, fill = per_cent) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21, fill = years) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.5, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_point(alpha=0.8, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_violin() +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_dotplot(alpha=0.8, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = years, y = per_cent, color = years)) +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_dotplot(alpha=0.8, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
geom_dotplot(alpha=0.8, color ="black", shape = 21) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +   ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(width = 0.5, show.legend = FALSE, outlier.shape = NA) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(show.legend = FALSE, outlier.shape = NA) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.5, show.legend = FALSE, outlier.shape = NA) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.shape = NA) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.5) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.3) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 0.4, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021") +
plot.title = element_text(size = 11)
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021") +
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title.position = "middle") +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none") +
ggtitle("Health Boards values overlay for 2010 and 2021")
?plot.title.position
?theme
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=11)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage", size = 8) +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
library(here)
library(tidyverse)
library(viridisLite)
#read the data
rank_data <- read_csv(here("Inputs/rank_data.csv"))
rank_data_NEW = rank_data[, -c(1, 4, 5, 6, 9, 10, 12, 13, 14)]
glimpse(rank_data_NEW)
colnames(rank_data_NEW)[colnames(rank_data_NEW) %in% c("measure", "comparator_value")] <- c("finish_2021", "start_2010")
presc_data <- rank_data_NEW %>%
mutate(area_name = gsub ("NHS", "", area_name)) %>%
rename(health_board = area_name)
ID_rank_data <- presc_data[, c("health_board", "area_code")]
write_csv(ID_rank_data, "ID_rank_data.csv")
#remove area_code column
plot_data <- presc_data [, -c(2)]
write_csv(plot_data, "plot_data.csv")
ggplot(plot_data, aes(x=start_2010, y= health_board)) +
#include point appearance
geom_point(size = 3, color = "red", shape = 21, fill = "orange", stroke = 1) +
#include segment appearance
geom_segment(aes(x=start_2010, xend=finish_2021, y=health_board, yend=health_board) , size = 0.5, color = "black", linetype = "dotdash") +
#include plot theme
theme_light() +
theme(panel.border = element_blank() , panel.grid.minor.x = element_line() ) +
#include title and labels
ggtitle("Anxiety & Depression prescriptions for 2010 - 2021") +
xlab("Percentage") +
ylab("")
plot_data2 <- plot_data  %>%
mutate(total_change = finish_2021 - start_2010) %>%
arrange(total_change)
write_csv(plot_data2, "plot_data2.csv")
plot_data2 %>%
arrange(desc(total_change)) %>%
mutate(health_board = factor(health_board, health_board)) %>%
ggplot(aes(x=total_change, y=health_board, size = total_change, fill= total_change)) +
geom_point(alpha=0.3, color ="black", shape = 21) +
scale_size(range = c(.1,17), name = "Percentage (%)") +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +
xlab("") +
ylab("") +
theme(legend.position = "none") +
ggtitle("Population % increase in drug prescription over 10 years")
summary(plot_data2)
colnames(plot_data)[colnames(plot_data) %in% c("finish_2021", "start_2010")] <- c("2021", "2010")
stat_test <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent") %>%
select("years", "per_cent" )
t.test(data = stat_test, per_cent ~ years, paired = FALSE)
#The negative t-value is due to the order of the groups. If the groups are switched, the answer will be the same, but with a positive sign.
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
library(latexpdf)
library(here)
library(tidyverse)
library(viridisLite)
library(latexpdf)
#read the data
rank_data <- read_csv(here("Inputs/rank_data.csv"))
rank_data_NEW = rank_data[, -c(1, 4, 5, 6, 9, 10, 12, 13, 14)]
glimpse(rank_data_NEW)
colnames(rank_data_NEW)[colnames(rank_data_NEW) %in% c("measure", "comparator_value")] <- c("finish_2021", "start_2010")
presc_data <- rank_data_NEW %>%
mutate(area_name = gsub ("NHS", "", area_name)) %>%
rename(health_board = area_name)
ID_rank_data <- presc_data[, c("health_board", "area_code")]
write_csv(ID_rank_data, "ID_rank_data.csv")
#remove area_code column
plot_data <- presc_data [, -c(2)]
write_csv(plot_data, "plot_data.csv")
ggplot(plot_data, aes(x=start_2010, y= health_board)) +
#include point appearance
geom_point(size = 3, color = "red", shape = 21, fill = "orange", stroke = 1) +
#include segment appearance
geom_segment(aes(x=start_2010, xend=finish_2021, y=health_board, yend=health_board) , size = 0.5, color = "black", linetype = "dotdash") +
#include plot theme
theme_light() +
theme(panel.border = element_blank() , panel.grid.minor.x = element_line() ) +
#include title and labels
ggtitle("Anxiety & Depression prescriptions for 2010 - 2021") +
xlab("Percentage") +
ylab("")
plot_data2 <- plot_data  %>%
mutate(total_change = finish_2021 - start_2010) %>%
arrange(total_change)
write_csv(plot_data2, "plot_data2.csv")
plot_data2 %>%
arrange(desc(total_change)) %>%
mutate(health_board = factor(health_board, health_board)) %>%
ggplot(aes(x=total_change, y=health_board, size = total_change, fill= total_change)) +
geom_point(alpha=0.3, color ="black", shape = 21) +
scale_size(range = c(.1,17), name = "Percentage (%)") +
scale_fill_viridis_c(alpha = 0.5, begin = 0, end = 1, direction = -1, option = "H", values = NULL, space = "Lab", guide = "colourbar", aesthetics = "fill") +
xlab("") +
ylab("") +
theme(legend.position = "none") +
ggtitle("Population % increase in drug prescription over 10 years")
summary(plot_data2)
colnames(plot_data)[colnames(plot_data) %in% c("finish_2021", "start_2010")] <- c("2021", "2010")
stat_test <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent") %>%
select("years", "per_cent" )
t.test(data = stat_test, per_cent ~ years, paired = FALSE)
#The negative t-value is due to the order of the groups. If the groups are switched, the answer will be the same, but with a positive sign.
box_plot <- plot_data %>%
pivot_longer(3:4, names_to = "years", values_to = "per_cent")
ggplot(box_plot, aes(x = as.factor(years), y = per_cent, fill = as.factor(years))) +
geom_boxplot(alpha=0.6, show.legend = FALSE, outlier.color = "red", outlier.shape = 19) +
stat_boxplot(geom = "errorbar", width = 0.2) +
geom_jitter(color = "black", size = 2, alpha = 0.8) +
ylab("Percentage") +
xlab("") +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size=18)) +
ggtitle("Health Boards values overlay for 2010 and 2021")
